<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>QuerySearchResult.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=2;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jacoco Coverage Report</a> &gt; <a href="index.source.html" class="el_package">models</a> &gt; <span class="el_source">QuerySearchResult.java</span></div><h1>QuerySearchResult.java</h1><pre class="source lang-java linenums">package models;

// import models.*;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Map;
import java.util.HashMap;
import java.util.Objects;
import java.util.concurrent.CompletableFuture;
import java.util.function.Function;
import java.util.stream.Collectors;

import Reddit.RedditHelper;
import play.libs.ws.*;
import java.util.concurrent.CompletionStage;
import com.fasterxml.jackson.databind.*;
import play.libs.Json;

import static java.util.stream.Collectors.*;
/**
 * This class will store all the data regarding all the Reddit Posts pertaining to a particular search term.
 * @author Saghana Mahesh Sarma
 * @author Sumit Ramesh Bhiungade
 * @author Jai Sahni
 * */
public class QuerySearchResult {
  private String searchTerm;
  private List&lt;SearchResult&gt; posts;
  private List&lt;SearchResult&gt; allPosts;
  private HashMap&lt;String, Integer&gt; analytics;
<span class="nc" id="L32">  private static String[] IGNORE_WORDS = new String[] { &quot;the&quot;, &quot;is&quot;, &quot;in&quot;, &quot;for&quot;, &quot;where&quot;, &quot;when&quot;, &quot;to&quot;, &quot;at&quot; };</span>

<span class="nc" id="L34">  public QuerySearchResult(String query) {</span>
<span class="nc" id="L35">    this.searchTerm = query;</span>
<span class="nc" id="L36">    this.posts = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L37">    this.allPosts = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L38">    this.analytics = new HashMap&lt;String, Integer&gt;();</span>
<span class="nc" id="L39">  }</span>
  /**
   * This is the getter method to get the search term associated with the search results
   * @author Saghana Mahesh Sarma
   * @author Sumit Ramesh Bhiungade
   * @author Jai Sahni
   * @return The search term associated with this search result
   * */
  public String getSearchTerm() {
<span class="nc" id="L48">    return searchTerm;</span>
  }
 /**
   * This is the method to clean the content of unrequired symbols
   * @author Saghana Mahesh Sarma
   * @author Sumit Ramesh Bhiungade
   * @author Jai Sahni
   * @return The filtered content
   * */
  private String sanitizeData(String content) {
<span class="nc" id="L58">    return content</span>
<span class="nc" id="L59">      .trim()</span>
<span class="nc" id="L60">      .toLowerCase()</span>
<span class="nc" id="L61">      .replace(&quot;,&quot;, &quot;&quot;)</span>
<span class="nc" id="L62">      .replace(&quot;\&quot;&quot;, &quot;&quot;)</span>
<span class="nc" id="L63">      .replace(&quot;!&quot;, &quot;&quot;)</span>
<span class="nc" id="L64">      .replace(&quot;?&quot;, &quot;&quot;)</span>
<span class="nc" id="L65">      .replace(&quot;:&quot;, &quot;&quot;)</span>
<span class="nc" id="L66">      .replace(&quot;.&quot;, &quot;&quot;)</span>
<span class="nc" id="L67">      .replace(&quot;(&quot;, &quot;&quot;)</span>
<span class="nc" id="L68">      .replace(&quot;)&quot;, &quot;&quot;)</span>
<span class="nc" id="L69">      .replace(&quot;-&quot;, &quot;&quot;);</span>
  }
  /**
   * This method is used to fetch the required data associated with a search term from Reddit, map it to the model class {@link SearchResult},
   * &lt;p&gt;
   * This method also used to perform the word stats on the query .
   * @author Saghana Mahesh Sarma
   * @author Sumit Ramesh Bhiungade
   * @author Jai Sahni
   * @param helper - This is the corresponding implementation you want to use to fetch data
   * @return The Reddit posts under a given search term
   * */
  public CompletionStage&lt;List&lt;SearchResult&gt;&gt; PopulateData(RedditHelper helper) {
<span class="nc" id="L82">    var response = helper.getSearchResult(this.searchTerm);</span>
<span class="nc" id="L83">    return response.thenApply((List&lt;SearchResult&gt; posts) -&gt; {</span>
<span class="nc" id="L84">      this.allPosts = posts;</span>

<span class="nc" id="L86">      posts</span>
<span class="nc" id="L87">        .stream()</span>
<span class="nc" id="L88">        .map((d) -&gt; (d.title + &quot; &quot; + d.selftext).split(&quot; &quot;))</span>
<span class="nc" id="L89">        .flatMap(Arrays::stream)</span>
<span class="nc" id="L90">        .map(this::sanitizeData)</span>
<span class="nc bnc" id="L91" title="All 6 branches missed.">        .filter(key -&gt; key.length() &gt; 4 &amp;&amp; Arrays.stream(IGNORE_WORDS).anyMatch(x -&gt; x != key))</span>
<span class="nc" id="L92">        .forEach(key -&gt; {</span>
<span class="nc" id="L93">          var currentCount = analytics.get(key);</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">          if (analytics.containsKey(key)) {</span>
<span class="nc" id="L95">            analytics.put(key, currentCount + 1);</span>
          } else {
<span class="nc" id="L97">            analytics.put(key, 1);</span>
          }
<span class="nc" id="L99">        });</span>

<span class="nc" id="L101">      return posts;</span>
    });
  }
 /**
   * This method used to fetch the reddit posts under a particular subreddits
   * @author Jai Sahni
   * @param helper - This is the corresponding implementation you want to use to fetch comments
   * @return The subreddit posts
   */
  public CompletionStage&lt;List&lt;SearchResult&gt;&gt; PopulateThread(RedditHelper helper) {
<span class="nc" id="L111">    var response = helper.getSubredditPosts(this.searchTerm);</span>
<span class="nc" id="L112">    return response.thenApply((List&lt;SearchResult&gt; posts) -&gt; {</span>
<span class="nc" id="L113">      this.allPosts = posts;</span>
<span class="nc" id="L114">      return posts;</span>
    });
  }
  /**
   * This method used to fetch the user info of the author of a reddit post
   * @author Saghana Mahesh Sarma
   * @param helper - This is the corresponding implementation you want to use to fetch comments
   * @return The information of the author
   */
  public CompletionStage&lt;List&lt;SearchResult&gt;&gt; PopulateUser(RedditHelper helper) {
<span class="nc" id="L124">    var response = helper.getUserPosts(this.searchTerm);</span>
<span class="nc" id="L125">    return response.thenApply((List&lt;SearchResult&gt; posts) -&gt; {</span>
<span class="nc" id="L126">      this.allPosts = posts;</span>
<span class="nc" id="L127">      return posts;</span>
    });
  }

  /**
   * This method is a getter method that returns all reddit posts
   * @return all reddit posts
   */
  public List&lt;SearchResult&gt; getAllPosts(){
<span class="nc" id="L136">    return this.allPosts;</span>
  }
 /**
   * This is the getter method to return all the posts along with their data under a given search term
   * @return A list of all Reddit data({@link SearchResult})
   * */
  public List&lt;SearchResult&gt; getData(){
<span class="nc" id="L143">    return this.posts;</span>
  }

  public void setAnalytics(HashMap&lt;String, Integer&gt; analytics) {
<span class="nc" id="L147">    this.analytics = analytics;</span>
<span class="nc" id="L148">  }</span>

  public HashMap&lt;String, Integer&gt; getAnalyticsData() {
<span class="nc" id="L151">    return this.analytics;</span>
  }

  public List&lt;Map.Entry&lt;String,Integer&gt;&gt; getAnalytics() {
<span class="nc" id="L155">    return analytics</span>
<span class="nc" id="L156">      .entrySet()</span>
<span class="nc" id="L157">      .stream()</span>
<span class="nc" id="L158">      .sorted((k1, k2) -&gt; -k1.getValue().compareTo(k2.getValue()))</span>
<span class="nc" id="L159">      .collect(Collectors.toList());</span>
  }
 /**
   * This is setter method that can be used to set the reddit data for given search term
   * @author chiragdahiya
   * @param posts - List of reddit data({@link SearchResult}) for given search term
   * */
  public void setKeyTermData(List&lt;SearchResult&gt; posts) {
<span class="nc" id="L167">    this.posts = posts;</span>
<span class="nc" id="L168">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>